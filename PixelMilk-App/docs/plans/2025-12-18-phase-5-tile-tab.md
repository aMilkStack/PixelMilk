# Phase 5: Tile Tab

> **For Claude:** REQUIRED SUB-SKILL: Use superpowers:executing-plans to implement this plan task-by-task.

**Goal:** Create tileset generation with seamless patterns, variants, and autotile support.

**Architecture:** Tile tab with description input, seamless toggle, variant generation, and autotile preview. Uses fast model for volume generation.

**Prerequisites:** Phase 4 complete

**Key Reference:** `C:\Users\User\Desktop\PixelMilk\Resources and Guides\nano-banana-infinimap-main\`

---

## Core Concepts

### Seamless Tiles
Tiles that connect seamlessly when placed adjacent. Generated by:
1. Creating base tile
2. Splitting into quadrants
3. Regenerating with edges matching

### Tile Variants
Multiple versions of same tile type for visual variety:
- Grass tile → 4-5 variants with slightly different details
- All share same edge style for seamless connection

### Autotile Rules
Generate tiles that auto-select based on neighbours:
- Inner corners, outer corners, edges, centers
- 47-tile blob autotile set OR simpler 16-tile minimal set

---

## Tasks Overview

### Task 5.1: Create Tile Store
```typescript
interface TileState {
  currentTileset: TileAsset | null;
  seamlessMode: boolean;
  variantCount: number;
  autotileMode: 'none' | 'minimal' | 'blob';
  // ... actions
}
```

### Task 5.2: Create Tile Generation Service
```typescript
// src/services/gemini/tiles.ts

export async function generateBaseTile(
  description: string,
  size: number,
  seamless: boolean
): Promise<SpriteData>

export async function generateTileVariant(
  baseTile: SpriteData,
  variationInstruction: string
): Promise<SpriteData>

export async function generateAutotileSet(
  baseTile: SpriteData,
  mode: 'minimal' | 'blob'
): Promise<SpriteData[]>
```

### Task 5.3: Create Seamless Preview Component
Shows 3x3 grid of tile repeated to verify seamlessness.

### Task 5.4: Create Autotile Preview Component
Shows all autotile pieces with neighbour context.

### Task 5.5: Create Tile Tab Layout
```
┌─────────────────────────────────────────────────────────────┐
│ [Description Input]              │ [3x3 Seamless Preview]   │
│ [Style Controls]                 │                          │
│ [Seamless Toggle]                │ [Variant Thumbnails]     │
│ [Generate] [Add Variant]         │                          │
├─────────────────────────────────────────────────────────────┤
│ [Autotile Preview - if enabled]                             │
└─────────────────────────────────────────────────────────────┘
```

### Task 5.6: Create Tileset Export
Export options:
- Individual tiles as PNGs
- Combined tileset image
- Autotile-compatible format (Godot, RPG Maker)

---

## Tile Prompts

### Base Tile Generation
```
Generate a ${size}x${size} pixel art tile.

TYPE: ${description}
SEAMLESS: ${seamless ? 'Edges must tile seamlessly in all directions' : 'No edge requirements'}
STYLE: ${style}

For seamless tiles:
- Left edge pixels must match right edge
- Top edge pixels must match bottom edge
- Avoid large details that break tiling
```

### Variant Generation
```
Create a variant of this tile with subtle differences.

ORIGINAL TILE: [attached]
VARIATION: ${instruction || 'Add visual variety while maintaining tileable edges'}

Keep:
- Same colour palette
- Same edge pixels (for seamless tiling)
- Same general style

Change:
- Interior details
- Small accent placements
- Minor shading variations
```

---

## Phase 5 Complete

Deliverables:
- ✅ Tile store with seamless/variant/autotile state
- ✅ Tile generation service
- ✅ Seamless preview component
- ✅ Variant thumbnail grid
- ✅ Autotile preview (if enabled)
- ✅ Tileset export

**Next Phase:** Object Tab
